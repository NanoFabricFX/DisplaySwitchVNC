# DisplaySwitchVNC
A helper application to make life easier when connecting from a single screen RealVNC VNC Viewer computer to a multi screen RealVNC VNC Server.

## What does it do?
This application was created out of the need to view a single monitor at a time when connecting to my gaming desktop with VNC Connect. My gaming desktop has 3 monitors attached (was 4!), and I would often remotely connect to it using VNC Viewer from my Android phone. The current (as at 2019-01-16) version of VNC Connect does not feature the ability to easily switch between monitors.

This is where DisplaySwitchVNC comes in! I developed this application to run on my computer, which would provide an easy way to select which monitor I would see from my Android device (or in fact, any device with VNC Viewer). To do this, I leveraged an existing parameter of VNC Server [DisplayDevice](https://www.realvnc.com/en/connect/docs/server-parameter-ref.html#server-displaydevice). DisplaySwitchVNC enumerates the connected monitors, sorts them by top-to-bottom, left-to-right (as reported by Windows), and provides a simple UI to select a monitor and feed the required value to the DisplayDevice parameter.

There are 2 components to DisplaySwitchVNC - a Windows Service, and a user application. 
### Windows Service
This is responsible for writing the configuration changes to VNC Server, as well as tracking logon, logoff, lock and unlock events. DisplaySwitchVNC will cleverly swap to show the primary monitor when on the lock screen, so that you do not inadvertently lock yourself out your PC! The service will also watch for VNC connections, and use these to show/hide the User Application, as required. This is achieved by watching the Event Log, which VNC Server writes to by default.

### User Application
This allows the user to pick the display they want to see. It will "follow" the user between screens as they select them. By "closing" the main UI, it will be shrunk to a small button, to minimise the screen real estate lost. The User Application cannot be easily closed, to prevent getting "stuck" viewing a particular monitor. It can always be closed via the system tray icon, or Task Manager.

## Credits
### ExeMsiCombiner
This tool/code was sourced from [here](http://epav.co.uk/giles/)
It is used to combine the EXE and MSI files generated by the Visual Studio Setup Project

## Donations
Did DisplaySwitchVNC make a difference for you?  Any and all donations gratefully received! [PayPal donation](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=39P93C9GLB7PG&source=url)
